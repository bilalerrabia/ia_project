function [y1,af1,af2] = predictRNN(x1,ai1,ai2)
%PREDICTRNN neural network simulation function.
%
% Auto-generated by MATLAB, 25-May-2025 20:07:27.
% 
% [y1,af1,af2] = predictRNN(x1,ai1,ai2) takes these arguments:
%   x1 = 16xTS matrix, input #1
%   ai1 = 20x2 matrix, initial 2 delay states for layer #1.
%   ai2 = 10x2 matrix, initial 2 delay states for layer #2.
%   ai3 = 1x2 matrix, initial 2 delay states for layer #3.
% and returns:
%   y1 = 1xTS matrix, output #1
%   af1 = 20x2 matrix, final 2 delay states for layer #1.
%   af2 = 10x2 matrix, final 2 delay states for layer #2.
%   af3 = 1x2 matrix, final 2 delay states for layer #3.
% where TS is the number of timesteps.

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1.gain = [2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2];
x1_step1.ymin = -1;

% Layer 1
b1 = [-1.4771835414113820839;-1.3319164074359450822;-1.1738399869191251668;-0.9893649462151680174;-0.84427484747600400894;-0.68174688212111878016;-0.52515363666212377947;-0.44648045195787511297;0.22738094692686680598;-0.094114424378323471854;0.033284431047622277389;-0.23027966299189495114;0.39353447838215915855;-0.56951717592036010807;0.68847644481529657323;0.81810110617320574988;1.0234581949740120255;1.1499076289943908069;1.3328500089352475211;-1.5008951906687557631];
IW1_1 = [0.32581592862434616276 0.033045739798008066934 0.059007464392070392567 -0.17345091725534741989 -0.12085039645590062163 -0.093322216899132504064 -0.20001782426389955183 0.20064385398911643854 -0.36625959148339182203 -0.04544908703089851898 -0.12352131364409617287 -0.1476635992102936501 0.20377294768859707808 -0.22308420384646121537 0.30286347657962603419 0.1868292903591853571;0.05495509566868228557 -0.13118518439995877078 -0.27483067887952922215 -0.17839237539636546015 -0.023539895208878860305 -0.057932859869319883184 -0.096779217395984717953 -0.13991919107704431369 0.3022777479429644143 -0.095596350140007030349 0.23200425947851879838 0.14487165889894404458 0.22821926620156590682 0.29712741598492614647 -0.073945441907141418181 0.12342161902953824315;0.20316822067969617094 0.18025388852380838656 0.066357120203856728713 -0.29111322143440537813 0.0066088163910936852108 0.26770073707563873944 0.080791280673014595481 -0.15299095789402958334 -0.024442539058638419747 -0.21457647238488491981 -0.2182170842390628307 0.18440266428580620595 0.22026976440570100735 0.30185194059481945672 0.12290214619222369907 -0.066588647759719482577;0.173820879074974316 0.34269645926029884686 0.106389719654052195 -0.087865529289997829077 -0.23490348127412424839 -0.11370018506277371206 0.20653318012379781599 0.25723131422708533922 -0.28046869808310798122 0.05105944897366973545 0.29937134320529162901 0.043523701725267746609 0.27519955615054070286 -0.27299838027146400288 -0.19314364746785203653 0.29521207125732390475;0.11738948107665055087 0.074667447070483131122 -0.22088809185089422482 -0.2965503728521821647 0.020756320045643174982 -0.29306209835769642114 0.045809502557649033061 -0.23890271064341711549 -0.061502766582827557429 -0.11239175477956846183 0.11448614017879187033 -0.070756984700613520523 0.15348415573857965288 0.054356219570492261828 -0.28848298475225597759 0.13249935569579782135;0.12945515601237789216 -0.0010664793597817924173 0.21634343486429608028 0.17681615852841914283 -0.30712507582364773073 0.018919244009613318813 0.10742205044830641092 -0.37843696024643341813 0.1484393302754855315 0.37125560176702776527 0.012717583547448169448 -0.10418869124290480732 0.18805433872139776241 0.13711090721373317414 0.25890053229260823198 -0.16620329939711475653;0.20492815285617746457 0.23187861161493064643 -0.14099026858498137083 -0.069577168351908677546 -0.30163844884800627977 0.30738771315144985952 0.16330377562917394729 -0.054917482528415870191 0.33210032623808921626 -0.020057890897231908656 -0.17067438821463598586 -0.038166020819365063799 0.33536929262344283842 -0.16747873595438608763 -0.14229360568379095797 0.082339501437557721664;0.067236659096769652022 -0.35518709180566304662 0.28526336379452527092 -0.018331312154149639881 -0.18888821025314328494 -0.32383196609436526447 0.31940442316730754957 0.22084834189277235961 0.27865555780867068414 0.15848302248467538433 -0.38495761015530310933 0.15614310929057662047 -0.35748711391791210268 0.033226151617078696077 0.064158087622321127719 -0.26019941312145500323;-0.20282120807809228547 0.1977857592799396047 -0.022425263603699441967 0.35937712462973187 -0.22936569074884846642 -0.29220026009002170175 -0.34585803904052264679 -0.14563925730824442417 0.21844086694395373205 -0.25336995418157620685 0.048881734491245984464 -0.045690660716035010058 -0.10985459652621511195 -0.19450067278382113245 -0.24183986721924222163 -0.34467692284049461504;-0.036072438858650475446 -0.26971148798101929334 -0.21770634950496706161 0.30390530311458741064 0.26844856668196415139 -0.10858166238024717642 0.071185300096280032522 0.10630264444624845654 0.24203266196170358793 0.11781236597884416073 -0.25701842812906772195 -0.033849421285016938199 0.065581795936479322928 -0.16486427274322687508 0.25840854033137727885 0.23443710311744872521;0.24638830293895394585 -0.16679379215488193688 -0.24787769846097210125 -0.25166485618885964248 0.18736296797035317807 0.26179042727185147799 -0.11311783521241917938 0.027863948234735858717 0.19641276651501077266 -0.038952476760416847312 -0.32785593775675253569 -0.15758509180415536388 -0.18660634826885674764 -0.34228557078623256249 -0.34890166448281073608 0.26004228412216778832;-0.19535048536887658632 -0.0055581928445711317743 -0.24513250304629735643 -0.012936999043085053995 -0.12974841545292883915 -0.046494852612303412542 0.16666918319833379236 -0.25562614609928840936 0.10187460658215484466 0.17325098250610210249 -0.26439811774687682622 0.049961439120291578631 -0.32304901536052427202 0.10454756792768819806 -0.02585372986407874496 -0.41571754140930355925;-0.042985789300510446331 -0.091362386759141614445 0.23429969824097887643 -0.0043348914686788938763 -0.16770503554848328887 -0.13359110486526734607 0.24555152980071709434 0.10174687138536292474 0.095865749072613193338 0.14694546075238126837 -0.10456806670037456508 0.10789295209082576388 0.25760534796875106389 0.091330677779818861262 -0.10929885406710214413 0.17940649789114884727;-0.081636880532941227817 -0.041186992412038735123 -0.32342058082464869573 -0.13084203806627159317 -0.048876123262659457169 0.1035388753496049169 0.0069033044536715723952 0.20859178353080415347 -0.048595453015317764678 0.25393261315215248652 0.11077014579375862868 0.096237923997557761613 0.14623498252874395087 0.18085466007673653421 0.27209809012978064535 0.013173756141160541597;0.33007490939767347715 -0.055103586827757920774 -0.21104977258288118436 0.26298426439197508664 -0.048077162219107065499 0.30956850918107586823 0.15888800962802415717 -0.35149858866766076071 -0.17775939292062739594 0.24700340369207338109 0.3227599333145115823 0.0046080545955248328888 -0.17538441719433045529 0.18190214960131209643 -0.037067877204189018936 0.072041189456559878712;-0.0084753053361874605004 0.058423037048613908617 -0.28936667418487199699 0.29289438430552178216 0.11838862167291870631 -0.15904324469948388776 -0.15770083879886920286 -0.25033804160440353836 0.067312416741575953338 -0.26058752073921870318 -0.0088211877465623807909 -0.10946788328609362295 -0.25064385250490484047 0.19956358213860378448 -0.17342912127866302874 -0.32441996288552443772;0.21874612229730974744 0.12883893557996156654 -0.10161421360101967337 0.035001906051739847814 -0.060866922051473218436 0.11311934226408673632 0.13400562470923466085 -0.09674445557021757458 0.19653697609713721706 -0.11612731942101417459 -0.31213008537718361923 -0.015212921673615561677 0.10965006309081691549 -0.29034198242441250359 -0.34047608171577897762 -0.22526406062831372257;0.054810938475778323009 0.12044988027263583974 -0.51626970637032110201 -0.2339304455517088599 0.30113507579789411395 -0.19731828020201347407 -0.092030702335843955764 0.15698098688711201176 -0.15029994112431388498 0.19819543522233223909 -0.20075669136091803257 -0.36999066136620961665 -0.14983873519293633425 -0.080998039462753079754 0.22867021742905488391 -0.14771045905320273617;0.23682411644129655603 0.25319853285932364395 0.014981514536860177436 -0.29303695611395441656 0.33470928656607618068 0.41768031204448541338 0.2892186561397139255 -0.14292681798096579238 0.28889357137425625277 -0.27991082590143584463 0.17598559087009194024 -0.024416215264457304807 -0.22920887850661791907 -0.12779524361940286514 -0.0092358083149993042832 0.088130245164528553392;-0.066991918027897168209 -0.17342059424335368178 -0.012339136288704932037 0.11932423022681309943 0.31167400187044969062 0.12885015476868744155 0.082062233342773502343 0.12404739920694572708 -0.29982261922162883883 -0.12214964830865497614 0.27178391281270897206 0.32380804242285493588 0.014006656373306823962 -0.031239071791369834447 -0.25023375581142415225 -0.0752888800136031211];
LW1_1 = [0.200880362402238416 0.10334925723724142088 -0.15005879224055762577 0.24224720261797050291 -0.16567864568451423635 -0.23952324860561491349 -0.051252076017898100246 -0.20948015373397710359 0.33048697426593576232 -0.16465344401499293348 -0.24923736548268379809 -0.33083575202367510038 -0.075659089540772106464 -0.29061273886689698021 -0.072064979701526796219 0.21199617682388044448 0.23595717517238670724 -0.28225847963190642265 -0.22854659647876582329 0.19808289579686125248 0.25317259455093021892 -0.029030277120273294961 0.10494400013220045453 -0.24911799651714358617 -0.13611562847781910612 0.042329576593830166298 0.22955855599825286673 -0.28432641504024763757 -0.086386407271798623664 0.018200398483450622861 -0.28391532175528200188 -0.26353514761923618748 0.022873656870350023845 0.094005625348120985807 -0.14529621289363145453 -0.18551335156469578314 -0.24641573134692087987 0.078865232680082622552 0.30486492367429263162 0.098729286508085087326;0.27234024729491151939 -0.25990435233015696248 -0.068879846490400978287 -0.19404860915343932759 0.18353120555730612073 0.14929003704933699326 0.11125690724522026287 0.20806006151496544976 0.084762299900258797347 0.2234976947507300582 0.10191200605706739191 0.33756088974345993536 0.13764262787518252718 -0.090175979943217632329 -0.11562993821132494521 -0.32731655914206009284 -0.068865967830047197795 0.26620072740757477758 0.22553398292195594999 -0.08855443077126652629 -0.087999867882914542538 0.39111002520393262083 -0.010844517504994403631 0.2407836893802405287 0.14637562272892964965 -0.14393287566440021719 -0.10065279256719218692 -0.12205090808825151683 -0.087082080890747370905 -0.090511535078076715832 -0.45027155580166255966 0.27346151262208656663 0.32402505122902408585 -0.063642862255762905344 -0.064095384499620752794 0.23277146068779350219 -0.11482051839310060404 -0.0041486037046029322628 0.38992851937101336013 0.14149074912192849407;0.16685226519264267919 0.24829221335904233525 0.025600908174275967266 -0.3306643953017429638 0.034642053801700482818 -0.2568833294983470239 0.28506943524952660374 0.29465804498676195777 -0.12489411363603789007 -0.21131299340592243907 -0.083479475857931667582 -0.22814955892539087734 -0.061047238650969441742 -0.24098595551498852574 -0.087523719907706840071 0.16201517797058356818 0.18789916668734399363 0.24057271365634613769 -0.135507987466205293 -0.28266254156274450704 0.16987569402084026771 -0.086008927884300173661 0.21830322537947627337 0.33966649784343899698 -0.18688472324455027151 -0.22666827402269942859 0.18514962607838630904 0.15098040154423028603 -0.048684501033660426694 0.10418350451304853044 0.024167993517913946566 -0.32121336961629493034 -0.25911535617846309654 0.26034731281547285331 -0.18980781244114391937 -0.19903254162877642708 0.039784238080693867801 0.12610561545994719568 -0.016765354238867238162 0.2627929227144732427;-0.12417588716523882131 0.31344174564616378298 -0.042031874872170575663 0.11426521458301094891 -0.20254931026404154881 0.29322278912524069039 0.2529650970917320385 -0.10401667844385975581 0.036043856856234436636 0.15458390240503566693 0.02724457424061773464 -0.097926851719875640523 -0.12770915348958156166 -0.25214840199782573293 -0.1038254233268897514 0.32667904832413530158 0.27352617697996362001 -0.17725129605424105872 -0.091453601370857937058 0.083791516915900671192 -0.22008866695383982881 -0.070653647023436877417 -0.15037818938319050255 0.25281957379466923896 0.33189965323807313347 0.10609853692139945003 0.24361429346029209175 0.067999354111680371249 -0.11306884250566845429 -0.19488330261999153858 0.14382439587031561889 -0.11589301740599171342 0.10767485416889666094 -0.076315858340362877077 -0.34593772766292130161 0.21510548623500214127 0.12787194429385057015 -0.21825492668004567443 0.22555394486565169543 0.10838547875780293883;0.046866031971499924613 -0.2927201840327475213 -0.23593676709933233959 -0.11193741625694415831 -0.12192533084489622086 0.2623298717268367497 -0.0040033800978040720922 -0.37485907671263557495 0.11055677868394475638 0.2334849416091193397 0.25027425148480680894 0.077497358810222086167 -0.25312649182981689089 -0.28582610012460463178 -0.021868430187448006236 -0.013651941160888360696 0.20470771502975979028 0.12186937936487836354 0.1241559372682128487 -0.1463969684917545977 -0.27759038746674441489 0.11821879162394421936 -0.21755424123775246592 0.11457520049634531412 -0.19940417298152779413 0.12241001379135260652 -0.18687799271441185578 0.29263434205556976275 -0.23215682975249921083 -0.33005071787609463474 0.08525965831927358185 -0.33875075087412293007 0.18189022547166486254 -0.21417961996379875078 0.11544473016738866777 0.22837271100720996087 0.063674084933549229826 0.12322897004863581083 0.29609686677658986209 0.14335649537257805219;0.081596780359657047899 0.23923595734798452916 0.1539860365086243299 -0.24474905163164226152 0.084468853103265115201 -0.022298615819524348486 0.25119630730806907781 0.24126349085601242472 0.074526001926952314958 0.239433306052421635 -0.1981653140540742819 0.39006879456735948919 -0.16875265988126528227 0.12943137364622658847 -0.091921353413582276848 -0.30336370897611075748 -0.2305780084358671489 -0.16920172719647244564 0.24894366989272315172 -0.2802713111648447164 -0.14045028451441829431 -0.098308074216236385201 -0.075660830219517263839 -0.27362316942733994063 -0.24364821465225255936 0.20245575923462558188 0.064026109160490785044 0.30612570606336625412 -0.082619999186727896556 -0.17977069409709009462 0.28194572321416971894 0.12453251987054260452 0.089504819480050124003 0.011090780540084541061 -0.21655813619871663867 0.032266241197538410301 -0.11393787910416948439 0.28258998571843224612 0.15564580494557378465 0.23420536398971544823;-0.30455726419507378466 0.27847844505586821784 -0.37478198252132155499 0.12062876760108294516 0.015424875435957399739 0.061293371050885350759 -0.3245787185557690302 -0.28249086349354962655 0.19678632612020788284 -0.078218968641171102152 -0.32431907075218890935 0.13343669515226999622 -0.082260697198317869749 -0.31872752224845396496 0.10881955540791371506 -0.14210744549927425973 0.079580291764682231648 0.27841292292354685722 0.20114762095217331161 0.053169943817724413249 0.17610596047130064323 -0.0036616061794425688522 -0.051866225716398636769 -0.31932904129032907425 -0.33406029005307025237 -0.07471338035620399276 -0.083222972216988627681 0.28801398416808315917 -0.018182374330287565806 0.095981208350415375685 0.08315376782684592849 0.2208645597541216421 0.18001123100727928206 0.2840987213851042803 0.16855396281729720376 -0.032899055898211834736 -0.25602898503772386629 -0.041616720346651668583 -0.083192683987771992582 -0.016531486055792042611;0.069720547089295550891 -0.30838053953075367231 -0.0043796974096864784223 -0.18551259559717134251 -0.089473081905888943166 0.3575564966479848894 0.15625515308279397386 0.13020498030619725993 0.19159504125665891006 0.14637489795954705674 0.26457870910663922048 0.22678489212611377401 0.030801527009658758588 0.097476320057257467844 0.27668464461482195071 0.14866849784498956111 0.20389665110053883934 -0.06090048487026624574 -0.10616254323052144726 0.096413999954814200155 -0.085184787323927785296 -0.24075523526442099698 0.18524020953582057136 -0.18437443977553605312 0.15314323388125197778 -0.12805828270501892763 -0.29375237336404602662 -0.20118411084397619382 -0.1670801841219497208 0.22918882549409541616 -0.023649098029146463362 0.073596915112477248599 -0.13862357722441170926 0.12296350480659021254 -0.010612649338872232399 0.28231200345358786752 -0.23596113515784158943 0.047942175298232601877 -0.13026637124031323345 -0.013123089230344091999;-0.12259753457154808076 0.039067564351216534091 -0.30806162742211606886 0.4040926354388459929 0.10906495262180829209 -0.28322818390133397415 -0.19757729076808058788 -0.094749127262719903819 0.23594168483598049191 0.026563671093473333745 0.079172767156660536769 0.096674904346578216519 0.10459134037252115768 -0.22060824560866390542 -0.21511211713187802785 -0.30788305926384001987 -0.1940104831968093857 -0.18037738785192711233 -0.20359230755609308838 -0.16367577188408272137 0.28192302722768558532 0.18079177720128863927 -0.23543730936342915916 -0.20829915339632656957 0.18882292216326160283 -0.06262049476139180948 0.16214420772426701989 -0.066724318406565952255 0.24520484094766664684 0.2373478332545622127 -0.12648844905213610379 -0.12746681436219275962 -0.063826788892872493575 -0.050105600815125633796 -0.081147293961505689852 -0.27299831490891635077 -0.2126925158582776143 -0.12948413931227498175 -0.079697565093529154634 0.25870174955961283692;0.057519680677053673656 0.1454894417252864669 0.36064937192053009296 0.23579912089346874438 0.14690823548857534497 0.22296180695672396244 -0.29231534084482746483 0.02411846914945755746 -0.26181630558014368226 -0.35104041519796652659 -0.021385162969496454566 0.10446051531554204073 0.29525624839067116101 0.12589096630571439128 0.31248135892746270459 -0.068187350514978276039 0.16859379044808373016 0.14364557560292565142 0.077464594148357948655 -0.28917521687222375038 0.11210486145049725071 0.08659783071981576319 -0.25134170714403120117 0.085886921480696945541 0.23142927107914287865 -0.11606403786852415028 -0.32881220815292155901 -0.10121761624767665333 -0.0950927699270486676 0.22134912082585367354 -0.20332130114623336858 -0.044508497561463696013 -0.30733619278747675851 -0.14788708863270907945 0.14320920505286746649 -0.051779508313607315595 0.12779360756248883679 0.15741410645913989086 0.097250977823702136615 0.24989041906420816908;0.36134080218877279167 -0.032371479366353310414 0.048344381464171512497 0.2974571652080464923 -0.20014396881349780233 0.30777373162250176719 0.22892639295943936761 -0.14485871617712683945 -0.24460145338434777229 0.25995120171414609622 0.016117301254036028868 0.13445434345773737972 0.32093801905991031775 0.040593116574665438767 0.16539206629052388697 0.00099694723094521540616 -0.030077020883586939176 0.048215579698104311934 -0.41008628832234228501 -0.21530653948935601916 -0.094552499661302955025 0.13928672813483009008 0.15052568032048466162 -0.29824162867281617251 0.10612234583137794552 0.32783123620708071178 -0.059861319168911492072 -0.24026281777957383956 -0.023201040773041987225 0.015006766246999845432 0.21491344128248315859 0.1177571891811155097 -0.079541507729929253334 0.30281391672219931666 0.13237196010620150277 0.047763152466046801536 -0.088813046384231889019 -0.14541492977166295408 -0.085337922190661330557 -0.1696935015765264898;-0.026202295945797086929 0.17381697901458986744 0.28298816241698399043 -0.013007593974323067992 -0.04141257257331299596 0.19315861068101197739 -0.18892373903730530493 0.085929423503225715875 -0.16178890382681221372 0.11960880034724934162 -0.28033272219599286723 0.34378170252133988249 -0.23951509507130089305 -0.12547180146000619372 0.25564850292878915639 0.31234252359762998408 0.05815621766388582442 0.059416867932933055407 -0.14200475403849122102 -0.16927409888142566641 0.31547412600748570011 0.15753569526414576418 -0.25354264126851400185 0.14693408849610242739 0.28328700742114892863 0.19206088876337346072 -0.074735104127789483974 -0.18476609516503275654 0.24767024285224795155 0.0061722727634662289536 -0.14815078773680245838 -0.15739325268429860127 -0.043621963156994902899 0.32090533919950026132 -0.12293010250488120572 0.14545219783643170697 -0.21561415742105588533 0.17193247981664835922 0.21206673816505808294 -0.23294470561765773242;-0.3260071111741016936 0.18818793625420127125 -0.085109715081534559333 0.14778588925321906045 -0.071711074813369857228 -0.26063855774898864182 -0.28539049011599953998 0.054462833502097643401 -0.30099826134593316018 -0.10245099074307993658 0.37622144910086646741 0.042580102319781258646 0.26443325252964694494 0.22065619584291951139 -0.25087093643722901959 -0.18745805620186462015 -0.20346578507073614928 0.34273698685661324603 0.089626484844891177173 -0.048451319028383607601 0.26483230635882554216 -0.25243229775521380809 -0.304695150754352162 0.21340265608686909138 -0.090381477793000417065 -0.14240294441019432647 -0.18805498070376627795 0.22106175449917050968 0.12487040955258883745 0.21328789771791376029 -0.18131797885407266446 -0.11857057804640241949 -0.17846191492748894603 -0.099963164391867170844 -0.29497957845512029484 -0.18864267765355352546 0.16507974885737070059 0.16068004238347094459 -0.076199839012448283837 -0.26625795869780072289;0.29150131504975679286 0.067539296518524943869 0.26213214268508894245 -0.20932581173158223975 0.17980524952506760084 -0.038081820723006122587 -0.31336626927717298186 -0.32445983331216232681 -0.31472755210522457281 0.30442076181878358065 -0.10418103894595258374 -0.0663152912427329988 -0.18898388658431314324 0.21948043505006292753 -0.29037239794600344656 -0.26397969930774251024 -0.28583571064781115867 -0.12106956157775680682 0.051095768967486493439 0.2942937069963014185 0.24352313516523640957 0.24031067687903259755 0.13179357778481037844 0.045779862922504778455 0.1752378005688185747 0.067669483335358174281 0.088986557950235523062 0.02044246859953768175 0.16647995614741070702 -0.065020877956837405676 -0.14861676318731709134 0.15035120959747394487 0.21255036140092542496 -0.27283644501215376099 -0.23528819195077865789 -0.32119575936294275653 -0.21715634593773008865 0.31672936628894871047 -0.11658358748081723566 -0.22391560624778911182;0.30828671157334242015 0.024747237386585980295 -0.15118745738777070176 0.018597829851312613902 -0.2119609186346023133 -0.32423831965549831935 0.33707458576188620292 0.0010001699745947820186 0.044804785882567595146 -0.24561142420311557477 0.048962817525113722095 0.096567282064627238403 0.33896438485863511492 0.30495791253503096163 0.045497998551817922519 0.10198038066595838114 -0.1656627479967052452 -0.39004809413698704468 -0.13671273468582481603 0.080046888634580939947 -0.18513014173409264584 0.23759366982310861638 0.0029974737247307329559 -0.10828634743042056532 0.014787565495696410045 0.15985151517690576739 0.25334291504408118501 0.28357876443613788675 0.18253913373874783299 -0.068150750383681416023 -0.0079870684071559408523 -0.036169617120069851024 -0.0194529517074566137 -0.24969883734201497871 0.042471268269771690618 -0.24012676127182788766 0.17565228802440693845 -0.096709228469901001302 0.26624968913657209857 -0.25937723714183125168;-0.051063188466430098345 -0.068898152383567667911 0.31059753596212652527 0.21526058866290601057 0.28356740024727145055 -0.090754375840485096427 0.098147452770004250944 0.21119503244398180053 0.040318117385869461922 -0.13120777639605449294 -0.053338451625537582068 -0.05710778806312914041 0.079627828918810761305 -0.30484870613745845835 0.15764342735364048065 -0.31943121979605143546 0.23948796527903473685 0.17833314780748477091 0.30410361274661817932 -0.15628795066329723151 -0.11708056889933064759 -0.13287908721438748683 0.066973948065730731782 0.24477351709399838842 0.18305033088615538239 0.27563473417919293063 -0.36932759827387018348 0.37657727322665673908 -0.047846911103867927062 -0.14465358395018343418 0.04959082773214502915 -0.21053791593002071925 0.18177190693082495576 0.089570889691999944215 0.24953259735270433284 0.16150084060944075448 -0.022454491969924137568 -0.081755199271068959566 -0.0033302081309604064478 0.13762620706733269538;-0.13574483542165355354 0.18144365883674032358 0.25437536144047157016 -0.30089965818585495683 -0.18273493749253735818 -0.25338180413522148893 0.25627257525294394602 -0.38567876379606902404 0.30896354454623159436 0.0013047407477933658376 -0.30476248794117893892 -0.29793755425452767005 -0.1593189853163318459 0.071583983952294330533 -0.24927914614219634504 0.29140277053684071618 -0.018715073174347670454 -0.065146645628893884439 -0.21936791211142173119 0.031905027368598376514 0.15794816532451094737 0.13089327321299409901 0.16242007425811566534 -0.03299948944399665185 -0.28209102574609007386 0.26436856371507289065 0.1174690293131579466 0.054016418147177260034 -0.041320084091813570615 0.054774868072454033219 0.11437015172563225196 -0.0050019169645235698682 0.23060382953684283036 -0.2152299056957600043 -0.01637382766624343941 0.30206744823980935521 0.052097531979711481087 0.015483720447652029456 0.1623270878776131021 -0.31325823783103046161;0.27147676423986072392 -0.038280474174460864256 -0.043721738646944126316 0.011788182808048552896 -0.037437172873448491817 -0.017755419472519226587 0.39468989792740222233 -0.054039957650303990788 0.13780360625948784303 -0.19319988842792501504 0.11444562830133500619 -0.080330250850234569127 -0.28084997059754712723 -0.34818528610618282304 -0.32850759990979716552 -0.22781047796666786809 -0.17844058372192445061 0.11791950683131588451 0.15000273723927104452 0.14198144338992266245 0.15462226029778833314 -0.070156369247414709922 0.23780803766782446229 0.013794279297029553299 0.34265685631004011436 0.12878358678971515983 0.18958112103873026033 -0.12012188171287320471 0.08856970039093949032 0.0038120027531262064627 0.23797154759762476073 -0.012683456697560395801 -0.10661542534759409218 -0.13782829769955187715 -0.17961128932398728875 -0.054500382050438500592 -0.19883721476542873252 0.27689709462722494893 -0.27806341490800307037 -0.070474386621283080512;-0.0056263444387100198379 0.096979298734665847492 0.077385209578795369212 0.26876198391891109596 0.18888770700261015012 0.025123194194228350151 0.11454833402975182766 0.12708764177401679629 -0.091039667431035753431 -0.1567702462172557154 -0.025891122056500015525 0.020384762926389635856 -0.11584247885819960733 -0.2992122060868880884 0.028138741989449267411 0.090378489594154926001 0.20877130135723354076 -0.18692839813037265273 -0.21165327729355204456 -0.00086091909426469612112 -0.015189072381237038109 -0.18994509237736095786 -0.024481019487055773881 0.19489924018326043598 0.10477731506931689531 -0.32609460489625741175 0.33387204204617143555 -0.20384447830606494678 -0.29771778832428141826 -0.12926057020194448022 0.1721742283537639473 0.067289638862227690863 -0.32094199400194506344 -0.044463817576671164911 0.12658752377919454957 0.37157454808851919648 0.20638672992299139652 -0.32411850463287084079 -0.010710879035799513934 0.1032397833391926617;0.074629561102959179886 0.22714743923705058015 0.095447911807475138701 -0.11036322937176581971 0.12014558030410897593 0.21237043389372572966 0.25743556137477374701 -0.12783443970909671994 0.049715484114577268571 0.060125444220349356927 -0.10452610100534540094 0.097652927981512566147 0.20120325557264787109 -0.24899212708100659786 0.25110445377317702764 0.20870852298605147013 0.20717491637425830553 -0.19731723869847508923 -0.064138307586423720652 0.107975732213708292 0.35195353133316137351 -0.17665829375771391341 -0.12913340203342490997 0.021251411347666258195 -0.11190917284199881909 -0.16813524956783476583 0.37246318846341641695 0.021735910560669560038 -0.15394487149696992057 0.097008106864898566157 0.39812080768707819312 -0.29735831410160235011 -0.32567236829280915567 -0.07971586605456412733 0.2472373761365294631 -0.15235614828383658992 0.028160395411194569237 -0.18158964399798108169 -0.35638621235717132807 -0.24521201512963430869];

% Layer 2
b2 = [1.4995825576813923696;1.1880040767240007682;0.81155620279502860281;0.50675992479170928195;-0.17781297135110030183;-0.13852738636853337284;0.54606124411609280322;0.80949480290056008425;1.1812660916233266306;1.5256714256969756693];
LW2_1 = [-0.24724109973154148601 0.19024266542808410119 -0.23421046756966981683 -0.44127258002645602941 0.019240931509845703162 0.051805991464695937132 -0.053584751000558712708 0.048069323047391247783 0.20635510517316013601 -0.2642087993466829543 0.19805499800663575738 0.28373078567708515108 0.084338914361962433186 -0.2111490490945289733 -0.30712286994689141917 -0.1048606551372301271 0.053529383197642353698 -0.25019049601052278931 -0.021383397300836930188 -0.3302981080684112003;-0.18109201790437101653 0.29953454198944723386 0.35482087574103088334 0.0011283751752311844182 0.36640149627329843263 -0.3255650052435266617 -0.307015292714806598 -0.16741201098800079228 -0.070218956640659774271 0.21051571501752874838 -0.050595433833598595086 0.2102852626713433426 -0.11889430938896899947 -0.20098925111024085188 0.1985740882179298783 -0.29158023368525809449 0.31721918336896848256 0.11126247385750927255 -0.052069609581918398222 0.38044304622266461591;-0.22742193895480550259 -0.20205907954517379754 0.18524910497939017784 0.30898209248572250374 -0.21881109503984308429 -0.017429815417177241949 0.029150184572626618856 -0.19758097095827942269 -0.47842020196828560774 0.060180131318522941952 -0.14661012549023247353 0.18790110513671393067 0.075631768698007403873 0.38621350935380033276 -0.14257928022133187218 -0.2405304117864560387 -0.23052455734496021811 -0.20240551405989465339 -0.15122512769696760948 -0.37076459209164708275;-0.13805060522595671846 0.19039606479457460431 0.30588757121559490004 0.28741089686398041403 -0.10099523908023885777 -0.39695626717638676784 -0.04172064452117533323 -0.17813216673520410049 -0.4075738524334019397 0.27126401881590178622 -0.038083010813754043788 0.18008424104838333113 0.35279858790891704956 0.092237383569921158055 -0.1666182131312235748 0.02735314853462373838 -0.29226108979100157148 0.047257446317785722911 -0.32290829703817763852 -0.093107902741646972333;0.2535088602715199757 -0.13056526624365963341 0.0080723111865716543761 -0.5430781039038685698 -0.21642207686676717682 -0.17267178833262625259 0.19052201385167294445 0.1657324226552977231 -0.069982052921978746274 0.065098117781531697479 0.12500835332765919405 -0.2376412509058485889 -0.083765832714631061062 -0.25811756206460123586 -0.1947404656641908427 -0.076712165299736179147 -0.39128280850373498012 0.25458832451337942704 -0.033266237590347989828 0.24409949144420736711;-0.25138782156562133885 -0.37781988944000066688 -0.28179264327393072076 0.10764511461427293815 -0.15864089632326733303 -0.22653330578577560162 -0.11801533411041822963 0.20394629688063065087 0.015912919943258222594 -0.26652171682307529421 0.26395705232591937239 0.36474912190676173074 0.087825597320617870833 0.02323865528158441246 -0.3617115952943699142 0.34943765701656526179 0.12923591002666745542 0.27153291918682909145 -0.25103828392534643932 0.14363427284708379927;0.21701131783127805552 -0.30589813112410180196 -0.25391024268255568686 -0.15265918378573278824 0.17720292022156811096 -0.037545572471914222257 0.25996117838875865136 -0.33969322315964661785 0.40598769197110484708 -0.18730983361250821972 -0.17113992191446616986 0.32866833682008383954 -0.23556336948419112631 -0.29496468866506442286 0.079587716670952213249 -0.33820381345843614218 -0.33578440571644996293 -0.10185642595893446005 -0.049852726822824246222 -0.073208263742231882709;0.029979357339458702347 -0.16189827939878603802 0.047410052868256974401 -0.254822775475245622 -0.37493977137119421927 -0.2339876662296769827 0.011725096547303234806 0.18098493456492406595 -0.14372069898363309948 -0.20136123394168878309 -0.16813101516273123992 0.42810051042583224801 0.10647802955767142474 0.23793307433277913199 -0.12563316619428077647 0.0019280694615446485572 -0.12747878224719216833 -0.0186690253410310876 0.33037001399749926778 -0.17210476342188893439;0.017855569950426548181 -0.29823626411286419113 -0.25665565256727373988 -0.028269891630881331668 0.09272379829588678346 -0.13088651305558707261 -0.2679632052085474947 -0.17785270584673512628 -0.10768070822932918063 0.16879222995374770777 -0.12636153956901996498 0.2750685745732373011 0.21246864971720760829 0.28895347814829608346 0.24560625134024868799 0.037527948673943545277 0.41303378740133933622 0.22759221279445873698 0.055704265224190162298 -0.36606857893377109381;0.19778086536365571679 0.45994152846589658745 -0.17213525330329951246 -0.15255292336770465145 -0.22450014594726211414 0.18227565085064428851 -0.23373324696271566281 -0.077697395922348921893 0.020091143357300868255 -0.47591101462016149881 0.17371871253831178139 -0.44629761173718379696 0.13632083147477228047 -0.18293730490696030744 0.089907785952359417503 -0.31276125075201138825 0.27554847089705108987 0.077743158912001703031 0.40685118674714854103 -0.16391082119216313084];
LW2_2 = [-0.28564811352039426451 -0.40103806520391471757 -0.055946119055963576538 0.34966682618721078857 -0.080938186500463554784 0.020885742022875283808 0.014036688918377603422 -0.3323550311379204758 0.092142808727940825331 0.17621783951470301743 -0.10247389895906132418 -0.29662299047236934113 -0.21225485385026524043 0.19644853626388425472 -0.40020470820755926766 -0.37147808579773089477 0.14801926757820571545 -0.16640418225748510039 -0.03211224870676505222 0.35273939393993020142;-0.12890574205788432605 -0.37499836657295221309 0.36614720558481511636 0.15881063651423832361 0.19309939049401073086 0.35910750477002856274 -0.19800677418045084521 0.067902485122936034889 0.26077040735094769719 0.0052849537953563209547 0.3064879853658472042 -0.28572066930289596876 -0.11008121191946404482 0.07682169671648642062 0.022331894864124846034 0.26576427246276734806 0.38737064844835372712 0.011598947421294027518 0.15683739351683065322 0.048396606188891813649;-0.31259751339122249236 -0.32422490299014250503 -0.2889653406331402774 0.17469417899240846648 -0.41097303437071364129 0.13184147734957538112 0.09175470149898727612 -0.35748465645887322895 0.06427872447580196269 0.0036540899316483640459 0.069299137505868010911 0.025993029212460092015 -0.23550235249857420783 -0.25946545602846199374 0.13545825901298488847 -0.095749925254458578827 0.43171958181397357412 0.12421368068867628953 0.27901641795936016344 -0.11344630821536297316;0.2475551784257688237 0.25475911988803973118 -0.091091200881025388703 -0.031065878162215183889 0.3614203518757505007 0.14967208484667773871 0.36522439538634071665 0.34633935256941389413 -0.12542356080575425836 0.38573056166591634941 0.05440469487662095982 0.049910184809091949487 -0.19780522797339319951 0.24281615654358337797 0.16948075479843294211 -0.16162875720862307505 -0.16444597635326552165 0.31296224881695205999 0.26866997805742892647 -0.16407339518075014784;0.31697458586124060975 -0.1713955898373082376 0.17081026863006359973 -0.31294552062540470505 -0.43905997053059014901 -0.20022848384761929297 -0.25635021322296652757 0.0086956259337655252006 0.26378745544579101923 0.27633910916647924649 -0.21843428546154947112 -0.26358860806226924733 0.24534667938226042971 -0.12258983652389721097 -0.24957760336006870605 -0.15119813255965916521 -0.19050966391356338736 -0.25497252166512912597 -0.34581485234314873756 -0.21226516521846675034;-0.17979142368464501311 0.0077646515706588569924 -0.069493555595126266233 0.32540254943165752843 -0.06193453182429827647 -0.01469545024425975531 0.33164669451085088125 -0.026095129000815488196 -0.20819315298472679254 0.29219228985395284681 -0.31481928103945333586 0.037030498657478531921 -0.012495522743687422634 0.026815227024949553347 0.16033770145046255529 0.019248680817634804263 0.28847300589115354441 0.38269154855559961437 -0.29655186488299428715 -0.035490193572273974476;0.20456701762456427907 0.035443386671440396674 -0.12883890053606256165 0.31295349352643914154 -0.41217777658240822847 -0.21466068978102009757 -0.30356000776073877034 0.14919344721927010888 0.27940267439650645631 -0.047847360928430171523 -0.1725570984077110237 0.31336549790977774599 -0.14152541927382103482 0.035022776145725131869 -0.25079507525017025182 -0.23083372990929609814 -0.20256711279688538463 -0.10304328597329913408 0.34092466090553880109 0.12234334721103272414;-0.40584374071196360756 0.046235836645348089846 0.26921831307735943906 -0.071614003317832075624 -0.021885588708278586045 -0.15943256278981812746 -0.33389459797895570947 0.35531295642587562567 0.40967062175711643768 -0.29923462220638324949 -0.24727053910102300693 0.20290432334475644316 0.079818513375505731333 -0.16531012182381091269 0.090069729739025661264 -0.15494167412659826111 -0.062063008225444478427 0.24055792278347792879 0.15731606250816834724 -0.23580943611186461206;0.12131105004135074588 -0.12844783456650604725 -0.33773333885253659092 0.30488310562870546416 0.23889033456699992897 0.33579512675797007493 0.13034768590143200329 -0.076132795768489497368 -0.16165900467443738986 0.08935980967518436513 -0.090878993490696668989 -0.19194785812717118922 -0.38899909775206109597 -0.39012369190006757069 0.073213999745088437221 -0.058759662432237194651 0.40714144414188618848 0.044257350698225735031 -0.37530648400319271962 0.044863602625150267311;0.1762754598106263948 -0.053674429607538473586 -0.13817543022171632772 -0.16041247852779105809 0.3561975112630709206 -0.25584980558362380165 -0.26820442630640539683 0.18374325916265005221 0.21021501570204806364 0.057855529033378372272 0.34116519320927052306 -0.094309832892930003934 -0.17366491944961956473 -0.0129991865847462508 0.22695434911437056824 0.053448297191367052927 -0.32176285457580461324 -0.19561566412384853719 0.032699406829764396387 0.27515051628763143032];

% Layer 3
b3 = 0.82121912539082597693;
LW3_2 = [-0.68683444493296941236 0.48421942097162939955 0.53372678798697392732 0.046990837312193028952 0.65355746844821049901 -0.73325999581272383043 0.26380442177501645107 -0.12677759608970912142 -0.75958902500833702653 0.42248333265848414531];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2;
y1_step1.xoffset = 0;

% ===== SIMULATION ========

% Dimensions
TS = size(x1,2); % timesteps

% Layer Delay States
ad1 = [ai1 zeros(20,1)];
ad2 = [ai2 zeros(10,1)];

% Allocate Outputs
y1 = zeros(1,TS);

% Time loop
for ts=1:TS

      % Rotating delay state position
      adts = mod(ts+1,3)+1;
    
    % Input 1
    xp1 = mapminmax_apply(x1(:,ts),x1_step1);
    
    % Layer 1
    tapdelay1 = reshape(ad1(:,mod(adts-[1 2]-1,3)+1),40,1);
    ad1(:,adts) = tansig_apply(b1 + IW1_1*xp1 + LW1_1*tapdelay1);
    
    % Layer 2
    tapdelay1 = reshape(ad1(:,mod(adts-0-1,3)+1),20,1);
    tapdelay2 = reshape(ad2(:,mod(adts-[1 2]-1,3)+1),20,1);
    ad2(:,adts) = tansig_apply(b2 + LW2_1*tapdelay1 + LW2_2*tapdelay2);
    
    % Layer 3
    tapdelay1 = reshape(ad2(:,mod(adts-0-1,3)+1),10,1);
    a3 = b3 + LW3_2*tapdelay1;
    
    % Output 1
    y1(:,ts) = mapminmax_reverse(a3,y1_step1);
end

% Final delay states
finalats = TS+(1:2);
ats = mod(finalats-1,3)+1;
af1 = ad1(:,ats);
af2 = ad2(:,ats);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
