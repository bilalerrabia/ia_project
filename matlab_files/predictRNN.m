function [y1,af1,af2] = predictRNN(x1,ai1,ai2)
%PREDICTRNN neural network simulation function.
%
% Auto-generated by MATLAB, 10-Jun-2025 02:24:44.
% 
% [y1,af1,af2] = predictRNN(x1,ai1,ai2) takes these arguments:
%   x1 = 16xTS matrix, input #1
%   ai1 = 20x2 matrix, initial 2 delay states for layer #1.
%   ai2 = 10x2 matrix, initial 2 delay states for layer #2.
%   ai3 = 1x2 matrix, initial 2 delay states for layer #3.
% and returns:
%   y1 = 1xTS matrix, output #1
%   af1 = 20x2 matrix, final 2 delay states for layer #1.
%   af2 = 10x2 matrix, final 2 delay states for layer #2.
%   af3 = 1x2 matrix, final 2 delay states for layer #3.
% where TS is the number of timesteps.

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [0;0;0;0;0;0;0;0;0;0;0;0;0;0;0;0];
x1_step1.gain = [2;2;2;2;2;2;2;2;2;2;2;2;2;2;2;2];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.5076234338933813817;1.3354293390836837752;1.1818286537496416333;-1.0127517587182455205;0.83067562136386940974;-0.70031750123726999036;0.61049105369458900316;0.37439494351717067522;-0.2590647913519353307;-0.064411888490430044274;0.077825142700416696795;0.2187459531924195455;-0.39136708141035325692;-0.55049980385859653698;0.71499101275214682616;-0.88786707897632133335;1.0010474922260166331;-1.15529822873433341;1.3138986952145397247;1.4964314426653302359];
IW1_1 = [-0.09195044191993254068 -0.035570043458215995502 -0.0061643427779226461771 0.073527096934709310072 -0.18580842348704845746 -0.16989512085650540496 0.012812497646832090442 0.1282767249114077357 0.37982650746819102139 0.1437139452635933512 -0.37496598050309626338 0.37454244986536450179 -0.30094772541626707563 0.16411170602808228258 0.18948407003622630418 0.35778035998188695288;-0.27349197270540342997 -0.083941903223372360543 -0.028464633144847546753 0.10883403125052459881 -0.21199225851520669961 -0.268550235282092431 0.039981080420124742725 0.14795907659212981233 0.18463557035392930139 -0.045616303414269886163 -0.24933669709405645309 0.014981593732484924791 -0.35842331761035978177 -0.090350522551994799647 -0.15894009509109857659 -0.3020684220990483837;-0.03222783780219757449 0.29891270275554604474 -0.19457883926656227569 -0.29322599808016297507 -0.16080782599282433809 -0.21710804624750892899 0.10679842956818205724 -0.17057713119157993931 0.25597353713080206461 -0.13007936181151560917 -0.1366165842504547534 -0.31969095544681053189 -0.088149983501473933023 0.045479535409961364956 -0.025041543732400257938 -0.15980214176918206004;0.13748180852530872409 -0.26264865723186137103 -0.011599705206761264445 0.085620730472042938519 0.27077720365633706212 0.054390847515842423443 0.039330343791221092364 -0.065685645060693867436 0.053747011595759987268 0.064060041060282943426 0.14050611232176918319 -0.1404616209388831749 0.10779741770396289446 -0.10403238800909474226 0.25271357129962446209 0.070954039070647761944;-0.068277881391654915433 -0.13604501648903191691 0.23522226930828218916 -0.13080146750544791034 -0.18616891100082738619 -0.24180343984617994058 -0.20754973777857305128 0.11781293533160387688 -0.38278622498915909622 -0.053285601761299115908 -0.2051964479036511857 -0.22784913807975787359 0.2658440194962951586 0.17220517599226572991 0.17842522298230809041 -0.2779683373929064949;0.14834235122713487764 0.04582721478417332156 -0.090600287265638290712 -0.14573416552238629973 -0.018902457180342467635 0.36891057728256959614 0.10140850513727316107 -0.19746427070434868778 -0.038416518356068733719 -0.15942718058280477833 -0.2790362547719559827 0.34526826158895818075 -0.12555312088013700911 -0.069889508475654060771 -0.065992118349895642626 -0.16904007677637619689;-0.18038842022472656446 0.066945117802259493378 0.048555402656728696709 -0.10386864601715176115 0.33007137037330525065 -0.25864486555371563048 -0.083068525472598297998 0.2306651779841415173 0.10964116188251987749 -0.029164546004811504887 0.27185418684284601287 0.027059225487509476482 -0.015684135197233151776 -0.32355600100281534104 -0.28386349761034079808 -0.22628110501707143776;-0.1262218264319909522 -0.26769487118254664537 -0.15705127851278521955 -0.027418462876471351441 -0.2563554433817886169 -0.24297459375652641356 0.03951895056244858484 -0.30406737374815934194 0.029143984664206271096 -0.2310226961831118031 -0.23283023631510724183 -0.031223520406916595304 0.13546878872757386891 -0.13736851463164370668 -0.21372163314236186649 0.044063977383647943975;0.35565691357991058297 -0.27238626846301955409 -0.27119472495383184496 0.16507310634432673102 -0.083894050500846181762 0.1826514905914496667 -0.15272403588859254087 0.34023635296848248055 0.26801286504826726809 -0.27035557121497466593 0.39449527029564268599 -0.21954141709344751621 -0.084697013804319973285 -0.12046318263001343229 0.28882184530433768765 -0.069848036289918744024;0.16563021990884438384 0.078504206350769198397 -0.20731145987982696477 -0.038630113961379476673 0.077238700474802496343 0.096195221156484017611 -0.13304249304209808669 0.088676597245169352934 0.27433984227125968181 -0.12932844369679460939 0.043804401865853818954 0.27149010684923258196 -0.3341515821026302957 -0.37355925333070100214 0.36816266466593089435 0.23387945776291088618;0.067468732309617265863 -0.19704789857739832271 0.098699380614555173863 -0.35111919822246107081 0.031635939358727813153 -0.11341816906449922464 -0.271255915651974433 -0.17486669676814919905 0.054981413286619956748 0.071219039449950172216 -0.26552938111936036369 -0.31085666493236446817 -0.13045467274504687905 -0.22532405606862307423 -0.098627895156248396313 -0.088297597644894643132;0.11003784675023543793 -0.22835361725709094061 0.14119456595312543379 0.27821924115316931658 0.078741026365501856632 -0.26950443556994568839 0.35659444730571099313 0.27553422692218754175 -0.16366713848864100633 0.16180210410676443278 0.031050824295429879651 0.19009866913207795758 -0.31419752154853591852 0.2761352508407798334 0.25525978343798721992 -0.22617442607255744402;-0.24155902714989471725 -0.26887678975831558192 0.27636294328257904329 -0.14975448249421940972 -0.08024842791112193896 -0.34329466448302770054 0.038968353420258665387 0.22009350794265228335 0.0018463137254709429021 0.1269913256166548543 0.10780479706704206022 0.02907826573644661447 0.082140975830595305829 0.09677032726765207038 0.13186307208644543199 0.17642888051129973492;-0.081974595519181236991 -0.12079598821683022736 -0.17153172064059907242 0.20435583658112069227 -0.099402904276760198354 -0.062007500218876097919 0.029133429540957645615 -0.016559052199800812499 0.14297564584766508933 0.1385551278617102311 -0.13321491191740134075 0.21516421886100275951 -0.22716396229614374547 0.26587334115148114622 0.27311901362621182621 -0.30236749570544046994;0.014779705852048713455 -0.0077725054618402638143 -0.23686360468237788179 0.14065413814852226193 0.19866429219724535127 0.25674641464613584541 0.1045679483899472767 -0.038872355109165007692 -0.040040854186146113136 0.15392116515235659824 -0.25797606042656801018 0.012595247655038003393 -0.19971331547537460316 -0.11184801527552647171 0.11784583073998548819 0.025091619651816065434;-0.26669428823665847217 0.1973259520671659939 0.055997082314201584996 0.02001381315946340958 0.25571560202984894294 -0.01336344610115649395 -0.10445243716948530988 -0.053391933552642829863 -0.21761051420770330389 -0.19013963541474618313 -0.028573105805134692975 0.21573799523961831315 -0.041258603994089620981 0.2943006792154204132 -0.28070534519326456602 0.26346606433688224413;0.0043589259705289701632 0.062864615962885839195 -0.092400279141544874872 0.027503095571375636014 -0.029735555395601402651 -0.30362164843812583515 -0.16616063526479565859 0.078779288876758071791 0.20124090611451483923 0.15352830758610716555 -0.25715126740614602241 -0.11710738927913015572 0.048109125249846444727 -0.21310280739281828311 -0.14776395702040440172 -0.22307717621448397427;-0.12534735845310918112 -0.071391709650690485245 -0.10609787833863155992 -0.33184490626718443629 -0.14223805848833007137 0.13735799148095284572 0.29987166198198667022 -0.022755763490666186533 0.024529086789500231108 0.18992186021622006753 -0.037624564913954737511 -0.079646876586913301077 0.0033392706240017726478 0.29239272477072131284 0.23867312626023878819 0.1471660619831222927;0.080196944591977861738 -0.31993795569406158208 0.17903527200614696713 0.17850433278425603678 -0.018977482358769500598 0.12574268105489605496 -0.052023851039653540296 -0.13116479273266068439 -0.15230077318920121066 0.15969290987932235892 0.36183777878140344075 0.082870190757508649382 0.12629568214940942172 -0.040912204940883760418 0.29994739295840400217 0.3337709175178041332;0.25836032098188110862 0.079168105307276082083 -0.10722887585843414449 0.1659352590739415767 -0.14146590253543550597 -0.085650847035786292771 0.17841599376924743847 0.18972391346307684867 -0.40386408626205438921 0.1122418987039159044 -0.15914509820596386969 0.27583915003468867377 0.2116026010269855262 -0.23627523177585307845 0.033504591982386110194 -0.2110673681779986488];
LW1_1 = [0.28585838616442371674 0.00078058404009143892311 0.24271742188012168651 0.31760375082659225709 -0.064575156233535463413 0.10905223319869322696 -0.089772578681846668114 -0.17410624363996179964 -0.23020474889887398984 0.026408011193623546348 0.12865651838806335672 0.074273430188982372813 0.028795725966726505585 -0.038103867113826329904 -0.015477271721434935139 0.12987175448542156997 -0.033677317900355344116 -0.028267219793334852351 -0.018739136281859383043 0.29327864055381025477 0.27370632042416981333 -0.32159316743826099616 0.091889873725167867113 0.18604149653371587769 0.01283512451445705492 -0.084084569298882014254 0.24013036842915105873 -0.21329983275321245939 -0.068402520950955877921 0.19577179250985293768 -0.11558787384771600226 0.11358987701001550807 -0.23042066936713920255 -0.30129283934378586762 -0.3056177693449137478 -0.15006645838869769882 0.10681350507562732688 -0.3650810097650694086 0.24402221987017608251 0.025654726622943213599;-0.22437358158879067149 -0.1020826566973184607 0.26182464511920405803 -0.062462557595247790443 0.17255426383613706176 0.35029127042627916655 0.14806592294580231406 -0.32084882207998910442 0.11206454306952563782 -0.1292078956183914662 -0.14843881452298321455 0.32814775118357863981 -0.10378535258165044741 -0.0042417388709774708072 0.21481777485744249501 -0.13744482025913498657 0.15649470034102239135 0.18698292304928168517 -0.013667231191458805578 -0.21263433073673543294 -0.30840436695940692813 0.064394243446575932799 0.23163126777275250268 0.21927841325947933226 0.28485357289253954161 0.080232581063828828372 0.069969912332559086598 -0.02755793663312354827 -0.22694782380651315479 -0.17718861878515190789 -0.20339262736280863675 0.044887733078970142031 -0.085216233299201138429 -0.27937515216392072581 -0.18582547011117314661 0.31175835571487153786 -0.12172370524683207016 -0.22704784862220708797 -0.056816760157856527336 -0.18348067405076362579;0.27880354536981499791 0.18594547184824797292 0.056203842983982545134 0.064767576042107977141 -0.012431811887451210685 0.32938369139380474504 -0.19749169800646160233 -0.063386115352844760173 0.14681708410245616903 -0.27189822044932565603 -0.026629755406385458016 0.10295260516627764702 0.31282543183879807369 -0.12971564431261289885 0.00064822401450282079831 -0.13130084654785503795 -0.046996981035198913401 -0.12486321303101916014 -0.26020067886533720936 0.32279818129520182479 0.13541628440296732405 -0.18724095962634443313 0.29917134751190765929 0.19844467707762572517 -0.066060997166167714778 0.14367470693387451863 -0.33995780041078216271 0.052998591979221229553 -0.11798649309303919919 0.3049945986189838143 -0.11545834947596517184 -0.20363697383448553513 -0.18219721492644741501 -0.29177679852944227168 -0.25553323863630461599 -0.088709190074234792189 -0.25580022078095604465 -0.32500091492287180861 -0.099984762428923609767 0.021386280658588042308;-0.16057255914267667962 -0.17937524453932812696 -0.34761208989366565447 0.33711264839582277819 0.26379451311910184774 0.0015905222210201685595 -0.26269205103559839509 0.0015073091655848514653 -0.18781121342130535634 0.06310903016600387383 0.17306173278279399219 -0.3113402374853555532 -0.11829976843686168531 0.17971257013410743553 0.31211325608991141722 -0.32425708358189175851 0.15079161807469693146 -0.31742484048736541169 0.09876403918159555595 -0.1866346729001032434 -0.046323660581754383392 -0.26368626039656056781 0.10719778303020817412 -0.15317973791858244259 0.064157602757940135341 0.086141081924653847834 0.056393305537008144024 0.2060038350072233293 0.068318915635164720324 -0.048954404144767753315 -0.11946385125654780668 0.20668256290484848803 0.3095068653088882682 0.2949758500973349018 0.35716481037460284798 0.21582063724846684005 0.27672996138041094927 0.31010392400748004738 0.18042563668029418245 -0.2943736435291253728;0.22655976780353656586 0.18124104569022839173 -0.17718574976796971909 -0.085298639710096407773 -0.058954634683184715949 0.33367365651792968428 0.0083536171936845742686 -0.30566560672548703792 -0.10347470780256447231 0.098111756218858245382 0.19091378387775451153 0.18964247914018203534 0.042143287328526811419 -0.061377588851678425985 0.15853164278942591392 -0.309000364539942729 0.11834961146266728682 0.021292222802911611734 0.22028241026642347844 -0.2296762959363376766 0.20290089330601382422 -0.0024347840464929758689 -0.33420650750496894155 0.20889824554402272594 0.022939341265996081309 -0.25531667387561807203 0.21424658530283433033 -0.2160277384701428105 0.30754461916289055345 -0.086093118182840266961 -0.010277197046380968579 -0.085444343558613716771 -0.22717641927903478583 0.38257626630349084174 -0.34379768661451576284 -0.072168877283866464389 0.13680560030776020564 -0.17917640569347681456 -0.12992355815911185712 -0.29365368276311965001;0.21965972625096152893 -0.22002804066122469417 -0.031988410615526728653 0.099837686378645124075 0.24834511400745035159 -0.065919148969174529151 0.15748296844180972864 0.21927878065702546828 -0.33631234116012176383 0.046403570554998045672 -0.0079999038555743466616 -0.177993607523814934 0.057743232340510486367 0.26458812200243381207 -0.23711215176784322667 -0.11906461296468826006 0.34297914049807265435 -0.13289585612480958599 -0.28709399915808969661 -0.33714705793849231164 -0.089363637107935642301 0.28803130790081410417 -0.22671887339534554928 0.088818480832950130743 0.048925512675689050712 -0.26294331480852178862 -0.3024478752781172286 0.037502833799001079884 -0.28736096015454765107 0.097759645883342682904 -0.2684727749646662609 0.3460816422282533833 0.24423540763905851603 -0.07984035375217557462 -0.2939276097697675616 -0.18563363003318902877 -0.1702534795082870922 0.0078659606055681337983 0.097174329671416079246 0.15384317491253746146;-0.14906276610534438531 0.25673475131299072771 -0.025764802848504995275 -0.18168338346322809862 -0.30225092851747548117 0.24001358990761062495 0.01614473186567948193 0.30714461738272863522 -0.30988885748392602792 0.043319987181508846918 0.180279162210119831 0.19647889895332257271 0.014960912711159754171 -0.064325042339383839418 -0.14808512341583507377 -0.26522955399464770432 -0.15890066396146343419 0.072147136360543165368 -0.22106804126199697258 -0.10541215921585361803 -0.27561230534687725102 0.10573869028772119039 -0.26213038564229346195 -0.22439325970846485392 -0.31268078135512117344 -0.23886118875707632037 -0.031363972965218235578 0.13555784747154325798 0.15079876116616822146 -0.24463844865630984815 -0.14429595745391460282 -0.084070454536772920573 0.026151510659980538309 -0.10914918617850639937 0.10055252457146943157 0.33502879991225570366 -0.21164169052083975364 -0.066154546440570755061 0.23448546948056711581 0.14546892474001391071;0.30395286787326641909 0.25834893501206362965 0.24628791450885306746 0.21485311664503795037 0.27921576576229351074 -0.29257045470134129816 0.21396798796135374499 -0.03679201925767887349 0.13086327209523196391 -0.019316192321894763706 0.11795449725353848724 -0.078198803924727874892 0.045464024723856126531 0.15567393685676489401 -0.2467682297241267364 0.12423633006456222261 -0.21541499510426576069 0.2381975060733776961 -0.16270275227646763261 -0.15634396928981114661 -0.18543543595354344822 0.13034436670030880023 0.26622181875655109851 -0.10250261512157114729 0.21367545244630975487 0.33092289751042908152 0.29459791600355339503 -0.14767807315832640058 -0.29933703827720659074 -0.28237092889453063727 -0.12619028455272343625 0.077048761762391435037 0.11189802158038086866 -0.0055449563174096265505 -0.12270796420078192157 0.30823237037778417058 -0.042052639298495959885 0.33531051115768378823 0.11029244272473708033 -0.30948453255567265341;-0.2105573928847909726 -0.25470402884233828145 -0.36478520716442985883 -0.13286359647852749588 -0.20732511582204032896 -0.25963064640663779947 -0.12642151574160379046 -0.19362452464415658149 -0.10775404743394571827 -0.17517792769723183888 -0.15860941140737350175 -0.021564611673245272921 -0.15163540187730784048 0.20672673025042492823 0.011247581775648119937 0.2440949646305653753 -0.017002952748663330979 -0.24052320444512548248 0.11526448476608672222 0.03348229966995661111 0.10274616248245956041 -0.18669205412205089334 -0.0054647146066986070079 -0.015753613901622328525 0.14921290060286343526 0.0042100285313741271989 -0.13927054809851535655 -0.0074334688523402178695 0.14462768553441648911 -0.22556605420777603443 0.16682243385702980043 -0.12079077342244487481 -0.082041283251998151083 0.16151556035094399855 -0.29855106887646243319 0.16307186091138770045 -0.28065513657364210554 0.1945295362337129963 -0.23223907461949858111 0.050368348921283355446;0.19485095363411741864 -0.35719220101947690704 -0.051842114479646095315 -0.15936355376365524128 -0.30417465736953874789 0.099839125059071609503 -0.15616258568752880431 0.10895627929046772242 -0.030540729846226889743 -0.053927405412507720128 0.25294204132703262955 -0.20304364187610543513 -0.23098904304633804951 -0.32045991651181027216 -0.32830104173464125239 -0.14884665620901171845 -0.28339705649705687618 0.076652486753921736384 0.12179882116818696591 -0.10671954083386839263 0.026334164728184655119 -0.19363520054440233609 0.21831923947213091597 -0.016359952584580318702 -0.23444902994992497525 0.0892445862274790086 -0.038970185258855941091 0.10292614630125236641 -0.026607091208951015593 -0.22143965421783984304 -0.13005849450291773195 -0.18887494276405303317 -0.249387444578912848 0.19048316793581121509 0.13581842725258569393 0.012314684251445903382 0.074037867328842460468 0.24354828070056108724 -0.091813740277662647671 0.048327624228749713198;0.23471065002149790746 0.036804512724758389752 -0.2181967246140980865 0.26279126779521061463 -0.296885874923538573 -0.051663996051601365767 -0.20808125095340448962 0.17476093198162165332 0.31455004199205260917 0.13275051670930670955 0.12455158805716597115 0.27372524883190235689 0.1718144354360081616 -0.034181403851937505745 0.023765466847883082169 -0.26891452703586143924 0.093760313478584336733 0.096882373111152969569 0.0063516924124308602254 -0.21932181265037431483 0.25341038503742535637 -0.32902780538114678732 -0.035650766118016832817 0.0020483605042016014147 -0.39110633117623427868 0.16309767786457698979 -0.19816022439610062045 -0.19754633292504858444 -0.26440756879618670938 0.10972245613541987963 0.22167340818626887766 -0.012721789130728017661 -0.26198772007458132061 0.17531011449052552598 0.17273284924542206542 -0.082396860731012447343 -0.20748004686033977295 0.041447190653464437149 0.28938405058202004705 0.20612688335125814443;-0.033524478745680881542 -0.31465933866951917297 -0.1990486166040945637 -0.008515247078258013011 -0.027992644780811801186 -0.04531638481378908595 0.32163727317078399937 0.018128000831868686799 0.14883220830601495699 0.30891041945849667671 0.086572073853148287514 -0.070900765627057674156 -0.2979414904886173443 0.28532808045766361316 0.28954735819118809781 0.23687092000997220231 0.039962460826219563248 -0.03229204589226861849 -0.059123563623360429753 -0.13059785518727201614 0.17418555219601289386 0.082270362134305718982 0.019149570024355928172 -0.12315256115012618299 0.15848627109109247879 -0.30356510645071482779 0.15026082256132183845 0.13789804832685800817 0.2633835902676887053 -0.046633498214153287775 -0.094455205458307725519 -0.23574122544055217676 -0.054493088158539815247 0.23879004124697655875 0.19278256296613222043 0.16781405488997211406 0.17627645288577625804 0.14744996961662698576 -0.30664436203857636798 0.034383792439920381201;0.28491536726801014456 0.26078262763793752521 0.15600308239336294069 -0.19653123602025329708 0.28763594484925053552 0.075333482542404336946 0.15454043513009940725 -0.26654026735713476359 0.031235233798669426869 -0.10209215710488959983 -0.38143653529997167961 -0.28310964801458848861 0.1802598381688944873 -0.040083820672707166921 0.13132342755903841924 -0.055115126689813491445 -0.077735333128540029524 -0.0018393564526764439628 -0.094951620693636662462 -0.22634069049786395555 -0.23673713058123907471 0.040996243002882147566 -0.04713641614868466917 -0.12038149549389344506 0.049188694868436751151 -0.20281358179610353698 -0.12981753879676238839 -0.29529203343380711067 -0.24895439637722840964 0.22275735430705861928 0.2465938279179185344 -0.2617421006032710773 -0.31039344621193676321 -0.33638090992495345288 -0.11605628329008006727 0.23806768475963946408 -0.13510210941093930836 -0.052737652595583009441 0.15198323676856070885 -0.20349857673519644585;-0.25714473043353081039 0.25164952498868342623 -0.13045475867434569439 -0.31368717567071890961 -0.17096441431746733919 -0.19728746070767896881 0.25960479149146092892 0.2207276960024989465 0.11571542637885494365 0.20869413382189486161 0.23932072351012659284 -0.33229188489349503755 -0.066733488803196433503 -0.13533108707172811225 0.26949704068110647004 0.12719757821420829558 -0.0076742578079304337932 0.31137536877994220763 0.074953417493749438516 0.22084555132577546321 0.26634085853593836291 -0.023012582121035039806 0.2861930392440358295 0.1100434508478051604 0.078222801917891771062 -0.090991850558074766075 -0.28482248498876716614 0.028563561594224320256 -0.27828195430823349232 -0.053412908327834587863 0.073253648153165817902 -0.27012441702418138467 0.015525184320821982728 0.25952431068601189423 -0.074558449549707445092 -0.34256209291393535654 -0.10180730693661212138 -0.12790318401771563761 0.24302636059821550174 -0.26610163937246938959;-0.24269102195641073516 0.17234443764496840124 -0.14117741306591102823 -0.26295436240322750399 0.216441710100887863 -0.037073624023140558381 0.11427069277145925075 0.34736167199358158886 0.10581223471917973467 -0.2766623468088718063 -0.18953183071388512992 0.012671005556754023902 0.22841743271827028017 0.044510233978592883552 -0.011134445578017094017 0.1976787383234805684 -0.036719534459241996716 -0.24417681310066918776 0.057977103813037632329 -0.28030739770089269092 0.17645881231871424211 0.23686209177890332755 0.25191527167856475611 0.2652175133655016448 0.090782993577024295728 0.27566003322132837106 0.33836780019645373851 -0.0068858052672543558492 -0.075197603951399405453 0.22383329621971517764 -0.29254802950070618595 -0.116782680276650494 -0.086530240366692434684 -0.3436548564653285065 -0.11031124608607567605 -0.27945179148050081075 -0.32651182591523270071 -0.26002295831964949979 -0.010933562274625463831 -0.29445061126008714725;0.20506057347394815449 -0.17422515663849302836 -0.25404168569943258449 -0.097343245249045931566 -0.21178864963097682184 -0.25545536565072052282 0.16036488007541777057 -0.21818484512360752925 -0.14541905969516494279 -0.34208120202389857845 0.21036123403224224471 0.31634991622173169734 0.29182573889539742407 0.18831766946368885818 -0.21366870422773232008 -0.019361270506596986452 -0.13291274251089330027 0.060645094736910945543 0.12935973745774165256 0.066148747413091929515 -0.34017206366911967308 0.27679583238489141594 0.040141109040752749604 0.088972087221391826795 0.13801955710504895669 -0.060766687265643277993 0.1166216922207139739 -0.33656993088593539776 -0.07565091568814437395 0.19483865184711993135 0.16507192028708009279 0.25612653155469583544 0.077633453518335795995 -0.24329072224512621192 0.070391199523474973221 -0.11540120522223397403 -0.32594703585042877902 -0.20068766755559858117 0.024801332770599392175 0.044493463279251299625;-0.34697173202136838421 0.052480297324619284982 -0.2316539260211307738 0.35103427103758050309 0.11994642148734468989 0.2351314417690154035 -0.10124770191632734284 0.31350289225713301455 0.20962226330204264402 -0.081026700439553941968 -0.068405277811140252631 -0.092095688253124724509 -0.038359033101517579778 0.13930062244919758085 -0.23902243089287281141 0.15624551567750460945 -0.28327796772909380474 0.093748757895905893145 -0.16827837010926957606 0.19349739792508613423 0.11589760863888358411 0.15582228678783893727 -0.14495941373826556897 0.063656226548308450508 0.26276481594119799334 -0.11484840778539054384 0.21441172408731706822 0.33800416647570608042 0.077145582766775994132 0.014985608469216576272 -0.28545203669284269221 0.046999261949414776474 0.099396050255423376574 0.15389491849516889754 0.20022092498330198995 0.091536813919213866342 -0.19636287240230126949 0.35636343294962230521 0.22917581734600422916 0.11902218530625431614;0.16051341865292195754 0.30717813872816218668 0.18466020040128000579 0.16674571666319951135 -0.17145928315159231214 0.045699308996192372634 0.084776081821648321957 -0.20100732398686710356 0.10371386709189138464 0.055374413570941069529 -0.030504988179296529255 0.044352430105627060897 -0.33474195235879178334 0.11672909954061747029 0.34519309113833457348 0.054271377359794849282 -0.14805729156050706496 -0.33576157434418685277 0.059142730542003696392 -0.3524736989347774796 -0.062786971202310276619 -0.13264349408347622661 -0.090711229420174968596 0.18237094963923447533 0.17317927619697029429 0.10069025079816254498 0.19232125278595973983 0.12779438322539143913 0.050951152749258751817 -0.1880081955371137592 -0.018118422301302970767 0.24136015640266655913 -0.26426169720785974704 -0.12793704852514628523 0.26773831489338945078 0.17850595546594724694 -0.20255252183580127467 -0.33111468871620131083 0.36841502272784026895 -0.12939249749557241165;0.1997790639573492899 0.27391669187769995819 -0.091378701338341680738 0.13680323956746254233 -0.17981538773562757982 -0.3499711633356444862 0.36406451193427052937 -0.030255992818585465687 -0.066565416534485347122 -0.13239402437121911005 0.1738514515736081234 -0.16858568248412383883 0.2722822464489477734 0.14896820515845510258 0.15804671401556208421 -0.019440737592365624903 -0.17950864213044781525 0.075559623180373791662 0.052948396372751421746 -0.25008453453670143052 -0.31448411439460099981 0.12782777265845673975 -0.16535176202587029137 -0.034406385550672810569 -0.18512396892872703957 0.13483666951886505436 0.13234737546385441642 0.19658881089118418473 0.32076810496114738225 0.023336248085559514742 0.23043985612873654767 0.24836540970996645594 -0.034353636967727696483 0.030596652046534899422 -0.1941875195442965274 0.28376987446966528417 -0.25507523969595169433 0.29052858374493739646 0.24424718134876832742 -0.0078122336288554755299;-0.25245794506411117775 0.072711282871347246437 0.14861238182094907434 0.21130164236043874615 0.18510856626171770523 -0.070111534164484082265 0.25660604774515710647 -0.3470562025281219154 0.13283426149514301895 -0.23412347499207630808 -0.26192733746611968071 -0.24669257790493678839 0.0535103363219741196 0.15193778868843962893 0.36301217625282133916 -0.23195507893902025942 0.24643389009683441815 0.17954756307557770412 0.36764573528322641582 -0.28438799789004359786 -0.25455324576937193859 0.21907564535537529804 0.1224468770614291907 -0.080662158584633270042 0.18658416298613406115 0.12856338625778551688 0.046078255003460286132 0.22141743771959448983 0.34916552153313429319 -0.063593014148711338174 -0.053510147359638882136 -0.071534804960151521236 -0.052461768171669309613 -0.054546621257969295227 -0.15785879296756494261 -0.26706479556002704623 -0.1416626255165316095 -0.0053968374187843932629 -0.077836950410149263746 -0.084772739706382244096];

% Layer 2
b2 = [1.494789162142956096;1.1358834166351881034;0.82439224233683050524;-0.51705007647898026946;0.18009735152118799828;-0.18239591172761446258;-0.51141269593721061515;0.8527774233350333688;1.1521011026301648528;1.4847140516181751568];
LW2_1 = [-0.29779240738508461206 0.18487388218738612378 0.21948166231136839732 -0.23801319808657392385 0.22722652756056788137 0.25032345997748584043 0.060574668554919462726 0.29769865922189719942 -0.18378553146037002186 0.3000884829402852283 0.20840554835846955561 0.32823031011019726533 -0.27703558426174812457 0.35855738928619512729 -0.0083795844721192107307 -0.080744791755013159418 0.13636206529903646678 -0.26961855744115348354 -0.29551332734048524342 0.34660414337568740129;-0.2866367318247809437 0.22065005426408892952 -0.27507875709010914944 0.33910149149111901146 -0.1951825325722372495 0.28286104449939314387 -0.12283927933495614182 -0.1905657053922494848 -0.33226206484660147922 0.26472326241143662173 0.2132074218215426753 -0.099571976602024825365 0.25129892054533942147 -0.19442749396109812454 -0.007392548460877159007 0.29032135147076604254 -0.073271063385385915012 -0.045028697149186530657 -0.25340801236572557675 -0.30230730082564138961;-0.29548014207975248357 -0.086926530632673720822 -0.038181597158345036147 -0.06876512289161412772 0.331859848104482269 -0.071097548969819429621 0.34528477852941719117 0.34690987698494329949 0.26283706644631299465 -0.28440220706008517704 -0.33756555904472546059 0.065984139849691036961 0.046061253526963552574 -0.19627839117758141829 0.080747969209365749732 -0.27339604387984489664 -0.14608633332623749412 0.14358027575954157573 0.22000475844353570287 0.35366795545894169628;0.10807825908870266618 -0.28981793191574456436 -0.3239984379747931631 0.35099221188889506706 0.2612950595271160692 -0.036869468537926747276 -0.31380616077649042817 -0.28306207296741253687 -0.32555082227926140925 -0.12931555790971785425 -0.29629303477962304347 0.20362510081808313234 0.006664040172010390721 -0.14672485971779700153 0.035437405132921505346 0.40614486725775372777 0.30654507504378891714 0.28962497601308917483 -0.078008339190508965699 -0.13223427318487285254;-0.18517119039850593598 -0.19326472255551196966 0.19467274485110480642 -0.11845310842921737138 0.13253448519598443056 -0.25693864520388709494 0.027004089631566384477 -0.12081121113635671926 -0.037107757973582108924 0.26440201938083235378 0.22496012634466849844 -0.036237642949324980202 -0.12841075948316407751 -0.061784032365106815454 0.27397179029081125679 0.20230552066392354371 -0.170784964431867331 0.084166512655468497806 0.35999444081735099132 -0.24432619806670780038;-0.24628811198544872663 0.14623173980629400326 -0.087775478733870967996 -0.34069579277795858374 -0.21641229402783609959 -0.21372665998257567299 0.36827312835045883377 0.34391036156448395733 -0.22590246418834689091 -0.29686638547071458882 0.075088793064075648465 0.13318153067930155187 -0.21112911857038274555 -0.030118909293311086489 0.24494951429164063539 -0.0023331208763334243886 0.072339213646080549602 -0.15731284967477163206 -0.22919435019797654296 0.28659094667560242042;-0.39017484906796012778 0.099380429070399414759 -0.25472867374682645059 0.099840616010894667198 -0.36720914226091461163 0.04349053138208748559 0.053111448931684165919 0.13395692249021479148 0.0013356885340576199819 0.26139028273687653359 -0.34527703544948679104 0.015093216858385190629 0.22285905424738694514 -0.27762468489812519579 -0.23737631602769143635 -0.28386858871067222054 -0.28314646367394813442 0.17858188000860589217 0.13560934629453885725 0.13237385257289743801;0.21254761537463615073 -0.34220984305264307013 -0.30273250489393693785 0.042772371168487539894 -0.2723762940060344695 -0.13820048561277975541 0.31645410467183604508 -0.077455979567623040039 -0.019494064884652186759 -0.35558619943776947903 -0.33742269681056047403 -0.12542538635991368201 -0.19430547688912438997 0.0363517092921563853 -0.23075673427914333846 -0.27101149449000999647 -0.12144049676333784626 0.061483456817011200579 -0.17755563091368256612 -0.0021147975646316043499;0.057175234753243958652 -0.084851969095767407203 -0.4143415543738111495 0.39775131205641839349 0.048421057930566453742 0.17497595285485728622 -0.19277093943316034319 0.08232715056491031469 0.19456145290854007235 0.22504086690847588392 -0.38606012114344639974 0.1877456342031579295 0.053060901510577095086 -0.20363831425559086874 -0.15374053462706541162 0.04630215687390525775 0.49466079331721896084 -0.051401961479116756171 0.27977831821283061231 0.11214893780535299672;0.053821987884719507678 -0.010696120731746297169 0.38092054623682386483 -0.26321139959541473008 -0.33096798978285574266 0.30501306938480615694 0.021124836856432592513 -0.39950262354993482106 -0.17067161072258377197 0.16739120335222770763 -0.29132393827804087261 -0.10229379191954691974 0.070810770986992663256 0.35760748052653829054 0.11356196132885174044 -0.38485157016544097042 -0.17014142911428373206 -0.40532451097011285013 0.0341509221144706554 -0.13250254319206292153];
LW2_2 = [-0.19676463560943319164 -0.27723317418835863313 0.063801813034215004716 -0.050378494968263153042 -0.32004509025661043164 -0.27428890190858767895 0.019541715652093071681 0.145005890929516712 0.26961985853121833712 -0.29356985900859855487 0.28571432824822873275 -0.19379641926826754461 -0.27291491351219077099 -0.021707411031795569023 0.0093639092972930982467 0.015108801040296304316 -0.35959792954640146245 -0.28517024797491291599 -0.15980011322132112173 -0.22259467140693317555;-0.35237867195333821835 -0.24247446449735085561 0.36965028002076155689 -0.037066658196819847471 -0.24506660934738466739 0.14337451772817430551 0.28342383703844675757 -0.24203781468144799915 -0.36784521763281580187 -0.24406459001892166771 -0.08958076345160691234 0.31706216757268035344 0.040761560093077978117 0.21063959720201227976 0.22226297760447796814 0.2693720517538764625 -0.074518175921657950345 -0.11625545562984232473 0.036601648065130117093 -0.34372102747690397306;-0.27127616464869869217 0.093452064716412153178 -0.0052526232856332649712 -0.25430005044127168556 -0.26150254089658697687 -0.011013058826085771885 0.16570755336704770522 0.15884931930193388339 -0.25482175445948418435 0.09931601046396269783 -0.24346295624600583496 0.33465988925442574642 -0.23580966720194387887 -0.26081256325420526521 0.14502391169717118724 -0.29487618822153677245 -0.28602987119770567626 -0.40617775876032602422 0.052364319864278335848 0.32636796454276806312;-0.11006085766294333717 -0.063350990067404397421 -0.097659556097432584365 0.30345371089564299183 0.063474667994713490637 -0.36056035853638801481 -0.019452279689632520632 -0.11119397145686363282 0.25899371189356901191 -0.33281241135789463303 -0.15885582142459067634 -0.13674025870430112084 -0.29834504413702478409 -0.32010152494060445383 0.1204263964364763323 -0.28187327158756547707 -0.1562774715303617834 -0.31025865450307799076 -0.2802354785628427547 -0.19423146622295145436;0.2651301123560870221 -0.30957511592266556688 0.35531055820712748039 0.33982320677746447046 -0.20671960629135319176 0.10823853820854976993 0.05373967101730453555 -0.31070574856555099874 -0.19702473171991313761 0.18733698148424673957 -0.13991163837323405961 -0.27131221154819101793 -0.04701606837017073548 0.19350579439374854251 -0.27278083150117798938 0.08144994392719026588 -0.23030444105045061454 -0.42976519470937801781 -0.30352401862912292696 0.082554611683969228442;-0.053830524932803373861 0.15700042135309408287 0.33320658633930239079 0.34053945791866024884 0.027007936055985375806 0.27183190514818394989 0.078941348282926093738 0.027103872977590866972 -0.15433844702393484383 0.056038449850054530832 -0.040192383933316012945 0.19365712524357511781 -0.19074874388893159338 0.067571042646764556405 0.032519005703098964599 -0.33941374658473633108 0.21491787003475767981 -0.26051088882908762789 -0.35801970255296788892 -0.19328932064598733365;0.10247512066697941902 0.10341630358099486442 0.30927727343393657256 -0.33388996147874883125 0.090883814404484272731 -0.29898462300045153262 -0.071616898659666389237 -0.0053268393166775312997 -0.13313689917161050658 0.22938350015313918595 -0.15266441640473221719 -0.28693114392219876141 0.35024200118713766372 -0.061773195638307250299 -0.1230741147386354567 -0.22489123347083667115 0.22125469625817489883 -0.22457860172326449266 -0.32034044385854193449 -0.26487242312561054547;-0.094290639170856671569 0.27540094152686334095 0.22199269880697169999 -0.35617162270305152694 -0.24486614922138891237 0.33167930297201825285 0.29374575497758736997 -0.41761569367329959279 0.26198017314432592295 -0.26052402126372325997 0.086675389480568992839 -0.0042543256757504154669 -0.0057690542053611378395 0.33721077721818915052 0.201093553113985829 -0.1684195746919615877 0.29375444821808915918 0.04287805668107291801 -0.011332701886905362232 0.17927731888813641659;0.31806618403585962263 0.10322148140620861223 0.15911423863377627264 -0.31337287448589645766 -0.24044875656370506833 -0.22550378256668193733 0.062531493030294774127 0.018004669403176694342 0.065446639337092535338 0.21747327281676254174 0.41640365979728988233 -0.058230515384017043912 -0.077720092934053297551 -0.026681203356637279295 0.043982497397208109025 0.42313993374802211234 0.28820635724010373879 -0.10509584968095500579 0.3142965325893720685 -0.33808038848000837584;0.22905672019058298527 -0.010332441209192575957 0.21573137413012474783 0.024733906915955335831 -0.11470860507271186945 -0.43616527829765944224 0.24844369540377858607 -0.17173263831723650785 0.2700245434518350196 0.22085752835565755636 -0.1866103687264111799 0.092454775336305569655 -0.18019905063494720543 0.36067541241207518032 -0.24135465482075887933 0.12277258010200890748 0.22317672377104788572 0.076457323210688044046 -0.18263159749852317382 0.27496529891004928281];

% Layer 3
b3 = -0.0045843453618275914127;
LW3_2 = [-0.73611609144986667186 0.87988020376938214095 0.24103196200056661858 -0.40333767644663132135 0.56064906527562130556 -0.64753637590010948433 0.43013540888898460501 0.4626761288311221354 0.29214187962738780158 0.52604225935794157731];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = 2;
y1_step1.xoffset = 0;

% ===== SIMULATION ========

% Dimensions
TS = size(x1,2); % timesteps

% Layer Delay States
ad1 = [ai1 zeros(20,1)];
ad2 = [ai2 zeros(10,1)];

% Allocate Outputs
y1 = zeros(1,TS);

% Time loop
for ts=1:TS

      % Rotating delay state position
      adts = mod(ts+1,3)+1;
    
    % Input 1
    xp1 = mapminmax_apply(x1(:,ts),x1_step1);
    
    % Layer 1
    tapdelay1 = reshape(ad1(:,mod(adts-[1 2]-1,3)+1),40,1);
    ad1(:,adts) = tansig_apply(b1 + IW1_1*xp1 + LW1_1*tapdelay1);
    
    % Layer 2
    tapdelay1 = reshape(ad1(:,mod(adts-0-1,3)+1),20,1);
    tapdelay2 = reshape(ad2(:,mod(adts-[1 2]-1,3)+1),20,1);
    ad2(:,adts) = tansig_apply(b2 + LW2_1*tapdelay1 + LW2_2*tapdelay2);
    
    % Layer 3
    tapdelay1 = reshape(ad2(:,mod(adts-0-1,3)+1),10,1);
    a3 = b3 + LW3_2*tapdelay1;
    
    % Output 1
    y1(:,ts) = mapminmax_reverse(a3,y1_step1);
end

% Final delay states
finalats = TS+(1:2);
ats = mod(finalats-1,3)+1;
af1 = ad1(:,ats);
af2 = ad2(:,ats);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
